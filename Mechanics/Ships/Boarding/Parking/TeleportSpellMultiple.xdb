<?xml version="1.0" encoding="UTF-8" ?>
<gameMechanics.constructor.schemes.spell.casterSelf.SpellCasterSelf>
	<Header>
		<resourceId>361930759</resourceId>
	</Header>
	<contextActionInfo>
		<contextName href="TeleportSpellMultipleName.txt" />
		<contextDescription href="TeleportSpellMultipleDesc.txt" />
		<contextImage href="/Interface/Icons/Spells/Mage/Gust.(UISingleTexture).xdb#xpointer(/UISingleTexture)" />
	</contextActionInfo>
	<Name href="TeleportSpellMultipleName.txt" />
	<Description href="TeleportSpellMultipleDesc.txt" />
	<image href="/Interface/Icons/Spells/Mage/Gust.(UISingleTexture).xdb#xpointer(/UISingleTexture)" />
	<nameTemplate href="TeleportSpellMultipleName.txt" />
	<descTemplate href="TeleportSpellMultipleDesc.txt" />
	<range type="gameMechanics.elements.calcers.FloatData">
		<value>5</value>
	</range>
	<prepareDuration>5000</prepareDuration>
	<immutablePrepareDuration>true</immutablePrepareDuration>
	<needLos>false</needLos>
	<targetType>STTSelf</targetType>
	<iffPolicy>Everyone</iffPolicy>
	<launchWhenReady>true</launchWhenReady>
	<needInFront>false</needInFront>
	<isAE>false</isAE>
	<mechanics>
		<casterConditions>
			<Item type="gameMechanics.world.ship.elements.PredicateStandingOnBoundShip" />
			<Item type="gameMechanics.constructor.basicElements.PredicateNot">
				<predicate type="gameMechanics.map.instance.astralIsland.PredicateOnAstralIsland" />
			</Item>
			<Item type="gameMechanics.constructor.basicElements.PredicateNot">
				<predicate type="gameMechanics.world.ship.elements.PredicateInInstancedSector" />
			</Item>
		</casterConditions>
		<casterImpacts>
			<Item type="gameMechanics.elements.impacts.SendImpactsToAddressees">
				<excludeCaster>true</excludeCaster>
				<addresseesFinder type="gameMechanics.elements.addresseeFinders.AddresseesCalcerGroupMembers" />
				<impacts>
					<Item type="gameMechanics.elements.impacts.ImpactsSwitchTarget">
						<cases>
							<Item>
								<predicates>
									<Item type="gameMechanics.elements.predicates.PredicateInCombat" />
								</predicates>
								<impacts>
									<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
										<distributor type="gameMechanics.elements.calcers.CasterDistributor" />
										<data href="SummoneeInCombat.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
										<calcers>
											<stringEntries>
												<Item>
													<name>summonee</name>
													<calcer type="gameMechanics.elements.calcers.TargetNameCalcer" />
												</Item>
											</stringEntries>
										</calcers>
									</Item>
									<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
										<distributor type="gameMechanics.elements.calcers.TargetDistributor" />
										<data href="SummonAttemptFailed.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
									</Item>
								</impacts>
							</Item>
							<Item>
								<predicates>
									<Item type="gameMechanics.world.ship.elements.PredicateStandingOnShip" />
								</predicates>
								<impacts>
									<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
										<distributor type="gameMechanics.elements.calcers.CasterDistributor" />
										<data href="SummoneeOnShip.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
										<calcers>
											<stringEntries>
												<Item>
													<name>summonee</name>
													<calcer type="gameMechanics.elements.calcers.TargetNameCalcer" />
												</Item>
											</stringEntries>
										</calcers>
									</Item>
									<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
										<distributor type="gameMechanics.elements.calcers.TargetDistributor" />
										<data href="SummonAttempFailed_OnShip.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
									</Item>
								</impacts>
							</Item>
						</cases>
						<defaultImpacts>
							<Item type="gameMechanics.elements.impacts.ImpactsConditional">
								<conditions>
									<Item type="gameMechanics.elements.conditions.CalcersCondition">
										<comparison>CasterLower</comparison>
										<casterCalcer type="gameMechanics.elements.calcers.CalcerMax">
											<calcers>
												<Item type="gameMechanics.elements.calcers.CalcerSectorAstralLevel" />
												<Item type="gameMechanics.elements.calcers.CalcerSectorAvatarLevel" />
											</calcers>
										</casterCalcer>
										<targetCalcer type="gameMechanics.elements.calcers.AstralUnlockCalcer" />
									</Item>
								</conditions>
								<impactsIf>
									<Item type="gameMechanics.elements.impacts.ImpactStartQuiz">
										<question href="Question.(Question).xdb#xpointer(/gameMechanics.world.quiz.Question)" />
										<participants type="gameMechanics.elements.addresseeFinders.AddressesCalcerSingle">
											<calcer type="gameMechanics.elements.addresseeFinders.AddresseeFinderSelf" />
										</participants>
										<resultsHandler type="gameMechanics.elements.common.SingleResultHandler">
											<impactsOnSuccess>
												<Item type="gameMechanics.elements.impacts.ImpactIfTargetGeneric">
													<predicates>
														<Item type="gameMechanics.elements.predicates.PredicateGreaterLong">
															<lhs type="gameMechanics.elements.calcers.CalcerLongParam">
																<paramName>choice</paramName>
															</lhs>
															<rhs type="gameMechanics.elements.calcers.LongData">
																<value>0</value>
															</rhs>
														</Item>
													</predicates>
													<impactsIf>
														<Item type="gameMechanics.elements.impacts.ReturningInstantiatingImpact">
															<impacts>
																<Item type="gameMechanics.elements.impacts.ImpactsConditional">
																	<conditions>
																		<Item type="gameMechanics.elements.conditions.CalcersCondition">
																			<comparison>CasterGreate</comparison>
																			<targetCalcer type="gameMechanics.elements.calcers.CalcerMax">
																				<calcers>
																					<Item type="gameMechanics.elements.calcers.CalcerSectorAstralLevel" />
																					<Item type="gameMechanics.elements.calcers.CalcerSectorAvatarLevel" />
																				</calcers>
																			</targetCalcer>
																			<casterCalcer type="gameMechanics.elements.calcers.AstralUnlockCalcer" />
																		</Item>
																		<Item type="gameMechanics.elements.conditions.PredicatesCondition">
																			<casterPredicates>
																				<Item type="gameMechanics.elements.predicates.PredicateNotInCombat" />
																			</casterPredicates>
																			<targetPredicates>
																				<Item type="gameMechanics.constructor.basicElements.PredicateNot">
																					<predicate type="gameMechanics.map.instance.astralIsland.PredicateOnAstralIsland" />
																				</Item>
																				<Item type="gameMechanics.constructor.basicElements.PredicateNot">
																					<predicate type="gameMechanics.world.ship.elements.PredicateInInstancedSector" />
																				</Item>
																			</targetPredicates>
																		</Item>
																	</conditions>
																	<impactsIf>
																		<Item type="gameMechanics.elements.impacts.ReturningInstantiatingImpact">
																			<impacts>
																				<Item type="gameMechanics.elements.impacts.ImpactTeleportToCasterTransport">
																					<slotName>Slot_Teleport_02</slotName>
																				</Item>
																			</impacts>
																		</Item>
																	</impactsIf>
																</Item>
															</impacts>
														</Item>
													</impactsIf>
													<impactsElse>
														<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
															<distributor type="gameMechanics.elements.calcers.CasterDistributor" />
															<data href="SummoneeRefused.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
															<calcers>
																<stringEntries>
																	<Item>
																		<name>summonee</name>
																		<calcer type="gameMechanics.elements.calcers.TargetNameCalcer" />
																	</Item>
																</stringEntries>
															</calcers>
														</Item>
													</impactsElse>
												</Item>
											</impactsOnSuccess>
											<impactsOnFail>
												<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
													<distributor type="gameMechanics.elements.calcers.CasterDistributor" />
													<data href="SummoneeRefused.(ClientData).xdb#xpointer(/gameMechanics.world.ClientData)" />
													<calcers>
														<stringEntries>
															<Item>
																<name>summonee</name>
																<calcer type="gameMechanics.elements.calcers.TargetNameCalcer" />
															</Item>
														</stringEntries>
													</calcers>
												</Item>
											</impactsOnFail>
										</resultsHandler>
									</Item>
								</impactsIf>
								<impactsElse>
									<Item type="gameMechanics.elements.impacts.ImpactClientDataParams">
										<distributor type="gameMechanics.elements.calcers.CasterDistributor" />
										<data href="/Mechanics/GameRoot/ClientData/Astral/AvatarLowLevelData.xdb#xpointer(/gameMechanics.world.ClientData)" />
										<calcers>
											<stringEntries>
												<Item>
													<name>name</name>
													<calcer type="gameMechanics.elements.calcers.TargetNameCalcer" />
												</Item>
											</stringEntries>
										</calcers>
									</Item>
								</impactsElse>
							</Item>
						</defaultImpacts>
					</Item>
				</impacts>
			</Item>
		</casterImpacts>
		<targetImpacts />
	</mechanics>
</gameMechanics.constructor.schemes.spell.casterSelf.SpellCasterSelf>
